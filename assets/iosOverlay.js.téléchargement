var iosOverlay=function(params){"use strict";var overlayDOM,noop=function(){},defaults={onbeforeshow:noop,onshow:noop,onbeforehide:noop,onhide:noop,text:"",icon:null,spinner:null,duration:null,id:null,parentEl:null},doesTransitions=function(){var s=(document.body||document.documentElement).style,p="transition";if("string"==typeof s[p])return!0;var v=["Moz","Webkit","Khtml","O","ms"];p=p.charAt(0).toUpperCase()+p.substr(1);for(var i=0;i<v.length;i++)if("string"==typeof s[v[i]+p])return!0;return!1}(),settings=function(obj1,obj2){var obj3={};for(var attrOne in obj1)obj3[attrOne]=obj1[attrOne];for(var attrTwo in obj2)obj3[attrTwo]=obj2[attrTwo];return obj3}(defaults,params),handleAnim=function(anim){"ios-overlay-show"===anim.animationName&&settings.onshow(),"ios-overlay-hide"===anim.animationName&&(destroy(),settings.onhide())},hide=((overlayDOM=document.createElement("div")).className="ui-ios-overlay",overlayDOM.innerHTML+='<span class="title">'+settings.text+"</span",params.icon?overlayDOM.innerHTML+='<img src="'+params.icon+'">':params.spinner&&overlayDOM.appendChild(params.spinner.el),doesTransitions&&(overlayDOM.addEventListener("webkitAnimationEnd",handleAnim,!1),overlayDOM.addEventListener("msAnimationEnd",handleAnim,!1),overlayDOM.addEventListener("oAnimationEnd",handleAnim,!1),overlayDOM.addEventListener("animationend",handleAnim,!1)),params.parentEl?document.getElementById(params.parentEl).appendChild(overlayDOM):document.body.appendChild(overlayDOM),settings.onbeforeshow(),doesTransitions?overlayDOM.className+=" ios-overlay-show":"function"==typeof $&&$(overlayDOM).fadeIn({duration:200},function(){settings.onshow()}),settings.duration&&window.setTimeout(function(){hide()},settings.duration),function(){settings.onbeforehide(),doesTransitions?overlayDOM.className=overlayDOM.className.replace("show","hide"):"function"==typeof $&&$(overlayDOM).fadeOut({duration:200},function(){destroy(),settings.onhide()})}),destroy=function(){params.parentEl?document.getElementById(params.parentEl).removeChild(overlayDOM):document.body.removeChild(overlayDOM)};return{hide:hide,destroy:destroy,update:function(params){params.text&&(overlayDOM.getElementsByTagName("span")[0].innerHTML=params.text),params.icon&&(settings.spinner&&settings.spinner.el.parentNode.removeChild(settings.spinner.el),overlayDOM.innerHTML+='<img src="'+params.icon+'">')}}};